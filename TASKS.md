# Tasks

> Task queue for RALPH loop. Work top-to-bottom. Mark complete with [x].

---

## Phase 1: PRD Completion

- [x] Write ch01.md PRD (The Compound Systems Engineer) (Completed: 2026-01-26)
- [x] Write ch02.md PRD (Getting Started with Claude Code) (Completed: 2026-01-26)
- [x] Write ch03.md PRD (Writing Your First CLAUDE.md) (Completed: 2026-01-26)
- [x] Write ch04.md PRD (The 12-Factor Agent) (Completed: 2026-01-26)
- [x] Write ch05.md PRD (The Verification Ladder) (Completed: 2026-01-26)
- [x] Write ch06.md PRD (Quality Gates That Compound) (Completed: 2026-01-26)
- [x] Write ch07.md PRD (Context Engineering Deep Dive) (Completed: 2026-01-26)
- [x] Write ch08.md PRD (The RALPH Loop) (Completed: 2026-01-26)
- [x] Write ch09.md PRD (Sub-Agent Architecture) (Completed: 2026-01-26)
- [x] Write ch10.md PRD (Building the Harness) (Completed: 2026-01-26)
- [x] Write ch11.md PRD (The Meta-Engineer Playbook) (Completed: 2026-01-26)
- [x] Write ch12.md PRD (Case Studies & Reference) (Completed: 2026-01-26)
- [x] Review all PRDs for consistency (Completed: 2026-01-26)

## Phase 1.5: PRD Enhancement (Based on Sub-Agent Analysis) - COMPLETE

> These tasks come from the sub-agent analysis of PRDs vs Knowledge Base (Jan 27, 2026)
> **ALL PRD ENHANCEMENTS COMPLETE** (Completed: 2026-01-27)

### Ch01-Ch04 PRD Improvements
- [x] Add liquidation-cadence.md reference to ch01 PRD (Completed: 2026-01-27)
- [x] Add building-the-harness.md reference to ch01 PRD (Completed: 2026-01-27)
- [x] Add building-the-factory.md reference to ch01 PRD (Completed: 2026-01-27)
- [x] Add information-theory-prompting.md reference to ch03 PRD (Completed: 2026-01-27)
- [x] Add prompt-caching-strategies.md reference to ch03 PRD (Completed: 2026-01-27)
- [x] Update ch04 PRD with Agent SDK v2-preview patterns (Completed: 2026-01-27)

### Ch05-Ch08 PRD Improvements
- [x] Add entropy-in-code-generation.md reference to ch05 PRD (Completed: 2026-01-27)
- [x] Add agent-reliability-chasm.md reference to ch05 PRD (Completed: 2026-01-27)
- [x] Add flaky-test-diagnosis-script.md reference to ch08 PRD (Completed: 2026-01-27)
- [x] Add ai-cost-protection-timeouts.md reference to ch08/ch15 PRDs (Completed: 2026-01-27)
- [x] Add errors-md-pattern.md reference to ch08 PRD (Completed: 2026-01-27)

### Ch09-Ch12 PRD Improvements
- [x] Add sub-agent-context-hierarchy.md concepts to ch09 PRD (Completed: 2026-01-27)
- [x] Add tool-access-control.md concepts to ch09 PRD (Completed: 2026-01-27)
- [x] Add orchestration-patterns.md concepts to ch10 PRD (Completed: 2026-01-27)
- [x] Add parallel-agent-execution.md reference to ch10 PRD (Completed: 2026-01-27)
- [x] Add plan-mode-workflow.md reference to ch12 PRD (Completed: 2026-01-27)
- [x] Add incremental-development.md reference to ch12 PRD (Completed: 2026-01-27)

### Cross-Cutting Improvements
- [x] Add Model Strategy (YOLO/Skills/Haiku-Sonnet-Opus) content to ch15 PRD (Completed: 2026-01-27)
- [x] Create index of all KB articles used in each PRD (Completed: 2026-01-27)
- [x] Ensure all 93 KB articles have at least one PRD reference (Completed: 2026-01-28)

### New KB Articles Needed (Critical Gaps) - TO BE CREATED
- [x] Create @kb/sub-agent-context-hierarchy.md (how sub-agents manage context isolation) (Completed: 2026-01-28)
- [x] Create @kb/tool-access-control.md (granting/restricting tool access to sub-agents) (Completed: 2026-01-28)
- [x] Create @kb/orchestration-patterns.md (coordinator, swarm, pipeline patterns) (Completed: 2026-01-28)
- [x] Create @kb/actor-critic-pattern.md (writer agent + reviewer agent pattern) (Completed: 2026-01-28)
- [x] Create @kb/agent-memory-patterns.md (checkpoint/resume, state persistence) (Completed: 2026-01-28)
- [x] Create @kb/human-in-the-loop-patterns.md (HITL implementation patterns) (Completed: 2026-01-28)
- [x] Create @kb/event-sourcing-agents.md (event log architecture for agent state) (Completed: 2026-01-28)
- [x] Create @kb/tool-call-validation.md (JSON schema validation for tool outputs) (Completed: 2026-01-28)
- [ ] Create @kb/ci-cd-agent-patterns.md (GitHub Actions patterns for agent verification)
- [ ] Create @kb/mutual-information-context.md (measuring context effectiveness)
- [ ] Create @kb/token-budgeting-strategies.md (allocating context by information density)
- [ ] Create @kb/lost-in-the-middle-mitigation.md (preventing context window degradation)
- [ ] Create @kb/checkpoint-commit-patterns.md (git commit strategies for AI workflows)
- [ ] Create @kb/batch-api-patterns.md (batch processing for cost reduction)
- [ ] Create @kb/prompt-injection-prevention.md (security considerations in prompting)

## Phase 2: Chapter Writing

- [x] Write Chapter 1 first draft (Completed: 2026-01-27)
- [x] Write Chapter 2 first draft (Completed: 2026-01-27)
- [x] Write Chapter 3 first draft (Prompting Fundamentals - NEW) (Completed: 2026-01-27)
- [x] Write Chapter 4 first draft (CLAUDE.md - was ch03) (Completed: 2026-01-27)
- [x] Write Chapter 5 first draft (12-Factor Agent - was ch04) (Completed: 2026-01-27)
- [x] Write Chapter 6 first draft (Verification Ladder - was ch05) (Completed: 2026-01-27)
- [x] Write Chapter 7 first draft (Quality Gates - was ch06) (Completed: 2026-01-27)
- [x] Write Chapter 8 first draft (Error Handling - NEW) (Completed: 2026-01-27)
- [x] Write Chapter 9 first draft (Context Engineering - was ch07) (Completed: 2026-01-27)
- [x] Write Chapter 10 first draft (RALPH Loop - was ch08) (Completed: 2026-01-28)
- [x] Write Chapter 11 first draft (Sub-Agent Architecture - was ch09) (Completed: 2026-01-28)
- [x] Write Chapter 12 first draft (Development Workflows - NEW) (Completed: 2026-01-28)
- [x] Write Chapter 13 first draft (Building the Harness - was ch10) (Completed: 2026-01-28)
- [x] Write Chapter 14 first draft (Meta-Engineer Playbook - was ch11) (Completed: 2026-01-28)
- [x] Write Chapter 15 first draft (Model Strategy & Cost - NEW) (Completed: 2026-01-28)

## Phase 3: Diagrams

> See `reviews/diagrams-2026-01-28.md` for full diagram review with draft Mermaid code (updated with ch14-ch15)

### High Priority (Chapters 1-7)

**Chapter 1: The Compound Systems Engineer**
- [ ] Create three-levels-pyramid diagram (Level 1/2/3 engineering)
- [ ] Create portfolio-vs-single-bet comparison diagram
- [ ] Create constraint-feedback-loop cycle diagram

**Chapter 2: Getting Started with Claude Code**
- [ ] Create agent-vs-chat mental model diagram
- [ ] Create tool-ecosystem radial diagram (7 core tools)
- [ ] Create two-mode-mental-model flowchart (explore vs implement)

**Chapter 3: Prompting Fundamentals**
- [ ] Create prompt-anatomy diagram (context/instruction/constraints)
- [ ] Create constraint-funnel diagram (state space reduction)

**Chapter 4: Writing Your First CLAUDE.md**
- [ ] Create why-what-how framework diagram
- [ ] Create hierarchical-claude-md tree diagram

**Chapter 5: The 12-Factor Agent**
- [ ] Create reliability-cascade bar chart (0.95^N formula)
- [ ] Create four-turn-framework comparison (demo vs production)
- [ ] Create 12-factors-overview organization chart

**Chapter 6: The Verification Ladder**
- [ ] Create verification-ladder stack diagram (6 levels)
- [ ] Create verification-sandwich pattern diagram

**Chapter 7: Quality Gates That Compound**
- [ ] Create state-space-reduction funnel diagram
- [ ] Create compounding-formula comparison chart
- [ ] Create six-gate-architecture pipeline diagram

### Medium Priority (Chapters 1-7)
- [ ] Create builder-metabuilder comparison (Ch 1)
- [ ] Create cost-curve-levels line graph (Ch 1)
- [ ] Create chain-of-thought flow (Ch 3)
- [ ] Create few-shot-accuracy bar chart (Ch 3)
- [ ] Create context-relevance comparison (Ch 4)
- [ ] Create instruction-degradation curve (Ch 4)
- [ ] Create reliability-stack layers (Ch 5)
- [ ] Create agent-loop flowchart (Ch 5)
- [ ] Create test-driven-search-space comparison (Ch 6)
- [ ] Create hook-workflow cycle (Ch 7)

### High Priority (Chapters 8-13) - First Drafts Complete

**Chapter 8: Error Handling and Debugging**
- [ ] Create error-classification pie chart (5-category distribution)
- [ ] Create context-debugging-hierarchy pyramid (4 layers)

**Chapter 9: Context Engineering Deep Dive**
- [ ] Create context-window-anatomy diagram (200K tokens, density)
- [ ] Create progressive-disclosure architecture (3 levels)

**Chapter 10: The RALPH Loop**
- [ ] Create ralph-loop-cycle diagram (7-step cycle)
- [ ] Create memory-architecture diagram (3 layers)

**Chapter 11: Sub-Agent Architecture**
- [ ] Create sub-agent-team org chart (orchestrator + 4 specialists)
- [ ] Create context-hierarchy tree (3 layers)
- [ ] Create actor-critic-loop cycle diagram

**Chapter 12: Development Workflows**
- [ ] Create plan-mode-phases flowchart (2 phases)
- [ ] Create git-worktrees parallel structure diagram

**Chapter 13: Building the Harness**
- [ ] Create four-layer-harness concentric diagram
- [ ] Create closed-loop-optimization cycle diagram

### Medium Priority (Chapters 8-13)
- [ ] Create learning-loop cycle (Ch 8)
- [ ] Create clean-slate-recovery flowchart (Ch 8)
- [ ] Create signal-degradation chart (Ch 9)
- [ ] Create entropy-reduction funnel (Ch 9)
- [ ] Create four-phase-pie chart (Ch 10)
- [ ] Create multi-agent-coordination org chart (Ch 10)
- [ ] Create parallel-vs-sequential comparison (Ch 11)
- [ ] Create incremental-development cycle (Ch 12)
- [ ] Create linear-vs-exponential comparison (Ch 13)
- [ ] Create mcp-query-flow diagram (Ch 13)

### High Priority (Chapters 14-15) - First Drafts Complete

**Chapter 14: The Meta-Engineer Playbook**
- [ ] Create skill-atrophy-ladder diagram (5 levels, career implications)
- [ ] Create six-waves-timeline diagram (Wave 1-6 progression)
- [ ] Create four-automation-levels diagram (0-3, productivity multipliers)
- [ ] Create fleet-model-evolution diagram (Human → Agent → Code progression)

**Chapter 15: Model Strategy and Cost Optimization**
- [ ] Create three-tier-model-hierarchy diagram (Haiku/Sonnet/Opus)
- [ ] Create progressive-model-escalation flowchart (with quality gates)
- [ ] Create multi-layer-timeout-protection diagram (4 defense layers)

### Medium Priority (Chapters 14-15)
- [ ] Create leverage-stack diagram (Ch 14)
- [ ] Create roi-calculation-flow diagram (Ch 14)
- [ ] Create yolo-safety-hierarchy diagram (Ch 15)
- [ ] Create model-selection-decision-tree (Ch 15)
- [ ] Create prompt-caching-structure diagram (Ch 15)

## Phase 4: Appendices

- [ ] Write Appendix A: CLAUDE.md Templates
- [ ] Write Appendix B: Prompt Library
- [ ] Write Appendix C: Troubleshooting
- [ ] Write Appendix D: Further Reading

## Phase 5: Review & Polish

### Cross-Reference Fixes (from review 2026-01-27)
> See `reviews/cross-refs-2026-01-27.md` for full details

**Critical (PRD Renumbering):**
- [ ] Rename prds/ch03.md to prds/ch04.md (Writing Your First CLAUDE.md)
- [ ] Rename prds/ch04.md to prds/ch05.md (12-Factor Agent)
- [ ] Rename prds/ch05.md to prds/ch06.md (Verification Ladder)
- [ ] Rename prds/ch06.md to prds/ch07.md (Quality Gates)
- [ ] Rename prds/ch07.md to prds/ch09.md (Context Engineering)

**Critical (Missing PRDs):**
- [ ] Create prds/ch03.md (Prompting Fundamentals - NEW chapter)
- [ ] Create prds/ch08.md (Error Handling & Debugging - NEW chapter)
- [ ] Create prds/ch12.md (Development Workflows - NEW chapter)
- [ ] Create prds/ch15.md (Model Strategy & Cost Optimization - NEW chapter)

**Critical (Broken Links in Chapters):**
- [ ] ch01 line 359: Fix ch07 reference to ch09 (Context Engineering)
- [ ] ch01 line 360: Fix ch08 reference to ch10 (RALPH Loop)
- [ ] ch01 line 361: Fix ch10 reference to ch13 (Building the Harness)
- [ ] ch03 line 496: Update ch09 reference (pending chapter creation)

**Medium (Missing Cross-Reference Sections):**
- [ ] Add "Related Chapters" section to ch04
- [ ] Add "Related Chapters" section to ch05
- [ ] Add "Related Chapters" section to ch07
- [ ] Complete cross-reference section in ch06

### Term Introduction Fixes (from review 2026-01-28, updated with ch14-15)
> See `reviews/term-intro-2026-01-28.md` for full details (58 issues across 15 chapters)

**Critical (High Priority):**
- [ ] ch01: Introduce CRUD, CI/CD, DDD, OTEL acronyms on first use (lines 73, 76, 86, 88)
- [ ] ch01: Add brief explanations for Terraform, Docker, Kubernetes (line 89)
- [ ] ch03: Introduce LLM acronym at start of chapter (line 3)
- [ ] ch04: Introduce Temporal tool on first mention (line 3)
- [ ] ch08: Introduce Claude Opus/Sonnet model tiers (line 222)
- [ ] ch11: Introduce hexagonal architecture pattern (line 64)
- [ ] ch14: Introduce K8s abbreviation (line 536)
- [ ] ch15: Introduce Haiku/Sonnet/Opus model tier names properly (lines 48-50)
- [ ] ch15: Define MTok abbreviation (million tokens) on first use (line 65)

**Medium Priority (Ch01-07):**
- [ ] ch01: Add jargon definitions for bounded contexts, aggregate roots, trace spans, idempotency
- [ ] ch02: Introduce JSDoc and JWT acronyms
- [ ] ch03: Add Zod tool explanation
- [ ] ch04: Introduce Supabase, RLS, tRPC, Cursor, Aider
- [ ] ch05: Introduce DAG acronym
- [ ] ch06: Introduce TLA+, Z3, fast-check, Hypothesis, Zod, io-ts tools
- [ ] ch07: Move DDD introduction earlier in chapter

**Medium Priority (Ch08-13):**
- [ ] ch08: Introduce bcrypt library (line 86)
- [ ] ch11: Introduce Result type pattern (line 35)
- [ ] ch11: Introduce JWT acronym (line 512)
- [x] ch11: Fix Chapter 15 reference (line 724) - chapter now exists (Completed: 2026-01-28)
- [ ] ch12: Consider expanding AST in section heading (line 449)
- [ ] ch12: Introduce slash command feature (line 515)

**Medium Priority (Ch14-15):**
- [ ] ch14: Add brief context for Factorio gaming reference (line 547)
- [ ] ch15: Introduce YOLO mode term with full explanation (line 437)

**Critical (Broken Cross-References in ch11):**
- [ ] ch11 line 724: Remove or update Chapter 15 reference (chapter doesn't exist)

**Chapters with Good Practices (use as models):**
- ch09: Explains info theory concepts thoroughly
- ch10: Properly introduces LLMs on first use (line 9)
- ch13: Properly introduces OTEL, DDD, MCP

### General Review Tasks
- [ ] Technical review all chapters
- [ ] Style consistency pass
- [ ] Validate all code examples
- [ ] Cross-reference check
- [ ] Final proofread

---

## Blockers & Notes

### Sub-Agent Analysis Summary (Jan 27, 2026)

**Coverage Statistics:**
- KB articles referenced: ~55/93 (59%)
- Unreferenced articles: 29 (30.5%)
- PRDs with complete KB coverage: 0/15

**Priority Improvements:**
1. Part III chapters (Advanced) need most work - missing entropy/reliability concepts
2. Ch09 (Sub-Agent) and Ch10 (Harness) have critical missing articles
3. New KB articles needed for orchestration patterns and actor-critic
4. Ch15 (Model Strategy) needs YOLO mode, Skills system, cost protection content

**TOC Restructuring Options (from sub-agent):**
- Option A (Minimal): Add missing KB refs to existing PRDs
- Option B (Moderate): Reorder some chapters for better flow
- Option C (Comprehensive): Split some chapters, merge others

**Current Recommendation:** Start with Option A (PRD enhancement), evaluate B/C after chapter drafts.
